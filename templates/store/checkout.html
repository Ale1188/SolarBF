{% extends 'base.html' %}
{% load static %}

{% block title %}Checkout{% endblock %}

{% block style %}
    <!-- <link rel="stylesheet" href="{% static 'css/checkout.css' %}"/> -->
{% endblock %}


{% block content %}

<form method="POST">
    {% csrf_token %}
    
    <h3>Shipping Address</h3>
    <div>
        <label for="street_address">Street Address</label>
        <input type="text" id="street_address" name="street_address" placeholder="123 Main St" value="{{ initial_data.street_address }}" required>
    </div>
    <div>
        <label for="city">City</label>
        <input type="text" id="city" name="city" placeholder="Your city" value="{{ initial_data.city }}" required>
    </div>
    <div>
        <label for="state">State/Province</label>
        <input type="text" id="state" name="state" placeholder="Your state" value="{{ initial_data.state }}" required>
    </div>
    <div>
        <label for="zip_code">Zip Code</label>
        <input type="text" id="zip_code" name="zip_code" placeholder="Postal Code" value="{{ initial_data.zip_code }}" required>
    </div>
    <div>
        <label for="country">Country</label>
        <input type="text" id="country" name="country" placeholder="Your country" value="{{ initial_data.country }}" required>
    </div>
    
    <div>
        <h3>Order Summary</h3>
        <ul>
            {% for item in cart_items %}
                <li>{{ item.quantity }} x {{ item.product.name }} - ${{ item.product.price }}</li>
            {% endfor %}
        </ul>
        <p>Subtotal: ${{ cart_total }}</p>
        
        {% if coupon_code %}
            <p>Discount (Coupon: {{ coupon_code }}): -${{ coupon_discount|floatformat:2 }}</p>
            <p>Total after discount: ${{ final_total|floatformat:2 }}</p>
        {% else %}
            <p>Total: ${{ cart_total|floatformat:2 }}</p>
        {% endif %}
    </div>

    <div>
        <label for="payment_method">Select Payment Method:</label>
        <select name="payment_method" id="payment_method" required>
            <option value="">Choose a payment method</option>
            <option value="debit">Debit Card</option>
            <option value="credit_card">Credit Card</option>
            <option value="paypal">PayPal</option>
        </select>
    </div>

    <div id="payment_fields">
        <div id="credit_card_fields" class="payment-method-fields" style="display: none;">
            <h4>Card Information</h4>
            <label for="card_number">Card Number</label>
            <input type="text" id="card_number" name="card_number" placeholder="Enter your card number" required>
            <label for="expiry_date">Expiry Date</label>
            <input type="text" id="expiry_date" name="expiry_date" placeholder="MM/YY" required>
            <label for="cvv">CVV</label>
            <input type="text" id="cvv" name="cvv" placeholder="123" required>
        </div>

        <div id="paypal_fields" class="payment-method-fields" style="display: none;">
            <h4>PayPal Information</h4>
            <label for="paypal_email">PayPal Email</label>
            <input type="email" id="paypal_email" name="paypal_email" placeholder="Enter your PayPal email" required>
        </div>
    </div>

    <button type="submit">Confirm Payment</button>
</form>

{% endblock %}


{% block scripts %}
    <script src="{% static 'js/checkout.js' %}"></script>
{% endblock %}
